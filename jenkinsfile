pipeline {
    agent any

    stages {
        stage("nuget") {
            steps {
                echo "Restoring NuGet packages"
                bat "dotnet restore"
            }
        }

        stage("build") {
            steps {
                echo "Build solution"
                bat "dotnet build --configuration Release"
            }
        }

        stage("publish") {
            steps {
                echo "Deploy to staging server"
                bat "dotnet publish --configuration Release -p:PublishDir=.\\publish"
            }
        }

        stage("deplay") {
            steps {
                echo "Copy files"
                bat "del E:\\INetPub\\JekninsInnoDay\\STAE\\*.*"
                bat "xcopy .\\publish E:\\INetPub\\JekninsInnoDay\\STAE /E /H /C /I"
                bat "dir E:\\INetPub\\JekninsInnoDay\\STAE"
            }
        }
    }
}