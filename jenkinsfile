pipeline {
    agent any

    stages {
        stage("nuget") {
            steps {
                echo "Restoring NuGet packages"
                bat "dotnet restore"
            }
        }

        stage("build") {
            steps {
                echo "Build solution"
                bat "dotnet build --configuration Release"
            }
        }

        stage("publish") {
            steps {
                echo "Deploy to staging server"
                bat "rmdir /s /q .\\publish"
                bat "dotnet publish --configuration Release -p:PublishDir=.\\publish"
            }
        }

        stage("deploy") {
            steps {
                echo "Copy files"
                bat "xcopy .\\publish E:\\INetPub\\JekninsInnoDay\\STAE /E /H /C /I /Y"
                bat "dir E:\\INetPub\\JekninsInnoDay\\STAE"
            }
        }

        stage("run") {
            steps {
                bat "E:\\INetPub\\JekninsInnoDay\\STAE\\InoDayJenkins.exe"
            }
        }
    }
}